"use strict";(self.webpackChunkreact_widget_template=self.webpackChunkreact_widget_template||[]).push([[328],{5362:(e,s,t)=>{t.d(s,{A:()=>r});var a=t(5043),l=t(8931),o=t(7111),n=t(3277),i=t(2725),c=t(579);const r=(0,a.forwardRef)(((e,s)=>{let{data:t,columns:r,addedItem:d,CAName:g,state:u}=e;const{showWarningToast:p}=(0,i.A)(),[h,m]=(0,a.useState)({});(0,a.useEffect)((()=>{m({})}),[t]);const f=()=>{const e=v.getSelectedRowModel().rows.map((e=>e.original["Available Plant"]));0!==e.length?(d(e),m({})):p(n.e1)};(0,a.useImperativeHandle)(s,(()=>({addPlant:f})));const y=(0,a.useMemo)((()=>[{id:"select",cell:e=>{let{row:s}=e;return(0,c.jsx)("input",{type:"checkbox",className:"form-check-input",checked:s.getIsSelected(),onChange:s.getToggleSelectedHandler()})}},...r]),[r]),v=(0,l.N4)({data:t,columns:y,state:{rowSelection:h},enableRowSelection:!0,onRowSelectionChange:m,getCoreRowModel:(0,o.HT)()});return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)("div",{children:[(0,c.jsx)("button",{type:"button",className:"btn btn-outline-primary me-3",onClick:()=>{v.getRowModel().rows.forEach((e=>e.toggleSelected(!0)))},children:"Select All"}),(0,c.jsx)("button",{type:"button",className:"btn btn-outline-secondary",onClick:()=>{v.getRowModel().rows.forEach((e=>e.toggleSelected(!1)))},children:"Deselect All"})]}),v.getRowModel().rows.length>0?(0,c.jsx)("div",{className:"overflow-auto",style:{maxHeight:"60vh"},children:v.getRowModel().rows.map((e=>(0,c.jsxs)("div",{className:"p-3 border-bottom d-flex align-items-center",style:{backgroundColor:e.getIsSelected()?"#d5e8f2":"inherit"},children:[(0,c.jsx)("div",{className:"me-3",children:(0,l.Kv)(e.getVisibleCells()[0].column.columnDef.cell,e.getVisibleCells()[0].getContext())}),(0,c.jsx)("div",{children:e.original[r[0].accessorKey]})]},e.id)))}):(0,c.jsx)("p",{className:"text-muted p-3",children:"No data available"})]})}))},4065:(e,s,t)=>{t.d(s,{G:()=>d,Rc:()=>u,Zy:()=>c,gV:()=>h,p_:()=>p,qv:()=>g,tu:()=>r});var a=t(9379),l=t(184),o=t(3825),n=t(579);const i=e=>{let{plants:s=[],itemId:t,isRemoveMode:a,handleRemovePlant:l}=e;return console.log("PlantRenderer received plants:",s),null!==s&&void 0!==s&&s.length?(0,n.jsx)(n.Fragment,{children:s.map((e=>(0,n.jsxs)("span",{style:{marginRight:"8px",display:"inline-flex",alignItems:"center",color:e.color||"black",fontWeight:"bold"},children:[e.PlantName,a&&"Pending"===e.PlantERPStatus&&(0,n.jsx)(o.zhF,{size:16,style:{cursor:"pointer",color:"red",marginLeft:"4px"},onClick:()=>l(t,e.PlantID)})]},e.PlantID)))}):"N/A"},c=e=>{if(!e||!e.cardData)return null;const s=e.cardData;let t={title:s.Title||"N/A",type:s.Type||"N/A","Maturity State":s["Maturity State"]||"N/A",owner:s.Owner||"N/A","Collaborative Space Title":s["Collaborative Space Title"]||"N/A",Description:s.Description||"N/A","Dropped Revision":s["Dropped Revision"]||"N/A","Latest Released Revision":s["Latest Released Revision"]||"N/A","CAD Format":s["CAD Format"]||"N/A",imageURL:s.imageURL||"https://oi000186152-us1-space.3dexperience.3ds.com/enovia/snresources/images/icons/large/I_VPMNavProduct108x144.png"};return"Document"!==s.Type&&(t.EIN=s.EIN||"N/A",t["CAD Format"]=s["CAD Format"]||"N/A"),t},r=(e,s,t)=>(console.log("cadata datahelpers",t),e?e.map((e=>"Change Action"===s?{ItemName:(null===e||void 0===e?void 0:e.ItemTitle)||"N/A",Plant:(null===e||void 0===e?void 0:e.ItemPlants)||[],ItemId:(null===e||void 0===e?void 0:e.ItemId)||"N/A"}:(console.log("change data datahelper",(null===e||void 0===e?void 0:e.Change)||t.CAName||"N/A"),{Plant:(null===e||void 0===e?void 0:e.title)||"N/A",Seq:(null===e||void 0===e?void 0:e.Seq)||"1",Status:(null===e||void 0===e?void 0:e.PlantStatus)||"Pending","MFG Change":(null===e||void 0===e?void 0:e.MFGChange)||"N/A","MFG Status":(null===e||void 0===e?void 0:e.MFGStatus)||"N/A",Change:(null===e||void 0===e?void 0:e.Change)||t.CAName||"N/A","Change Status":(null===e||void 0===e?void 0:e.ChangeStatus)||t.CAStatus||"N/A","Oracle Template":e.OracleTemplate||"N/A","ERP Status":"Active","ERP Export":"Yes","Lead Plant":!1,MBom:e.MBOM?"Make":"Buy","Sort Value":""}))):[]),d=e=>e?e.map((e=>({"Available Plant":(null===e||void 0===e?void 0:e.title)||"N/A"}))):[],g=(e,s,t,a)=>(console.log("type here is: ",s),"Change Action"===s?[{accessorKey:"ItemName",header:"Item Name"},{accessorKey:"Plant",header:"Plant",cell:e=>{let{row:s}=e;return(0,n.jsx)(i,{plants:s.original.Plant,itemId:s.original.ItemId,isRemoveMode:t,handleRemovePlant:a})}}]:[{accessorKey:"Plant",header:"Plant"},{accessorKey:"Seq",header:"Seq"},{accessorKey:"Status",header:"Status"},{accessorKey:"Change",header:"Change"},{accessorKey:"Change Status",header:"Change Status"},{accessorKey:"MFG Change",header:"MFG Change"},{accessorKey:"MFG Status",header:"MFG Status"},{accessorKey:"Oracle Template",header:"Oracle"},{accessorKey:"MBom",header:"MBom"},{accessorKey:"ERP Status",header:"ERP Status"},{accessorKey:"ERP Export",header:"ERP Export"},{accessorKey:"Lead Plant",header:"Lead Plant"},{accessorKey:"Sort Value",header:"Sort Value"}]),u=[{accessorKey:"Available Plant",header:"Available Plant"}];function p(e,s,t,l){return console.log("Assigned Plants are:",s),console.log("unique Plants are:",l),e.forEach((e=>{"New"===e.type?(t=t.filter((s=>s.title!==e.title)),l.some((s=>s.title===e.title))||l.push(e)):"Update"===e.type&&(t=t.map((s=>s.title===e.title?(0,a.A)((0,a.A)({},s),{},{MBOM:"false"}):s)))})),{updatedAssignedClasses:t,uniquePlant:l}}const h=e=>{if(!e)return"An error occurred.";const s=e.split("\n").filter((e=>""!==e.trim()));return(0,n.jsxs)("div",{style:{userSelect:"text",cursor:"text",position:"relative",paddingRight:"40px"},children:[(0,n.jsx)("strong",{children:"Errors:"}),(0,n.jsx)("button",{onClick:()=>{const e=s.map((e=>"- ".concat(e))).join("\n");navigator.clipboard.writeText(e)},style:{position:"absolute",right:"10px",top:"-12px",background:"none",border:"none",cursor:"pointer",fontSize:"16px",color:"grey"},children:(0,n.jsx)(l.zU_,{size:12})}),(0,n.jsx)("ol",{children:s.map(((e,s)=>(0,n.jsx)("li",{children:e},s)))})]})}},3127:(e,s,t)=>{t.d(s,{Bx:()=>n,Eo:()=>i,iu:()=>c});var a=t(9379),l=t(6047);const o=(e,s)=>{console.log("Data Received for ID Extraction:",e),console.log("[PlantAssignment] All Plants Data:",s);const t=e.map((e=>{const t=e.title.replace(/\s+/g,"").replace(/plant/i,""),a=s.find((e=>e.title.replace(/\s+/g,"").replace(/plant/i,"").toLowerCase()===t.toLowerCase()));return a?a.id:null})).filter((e=>null!==e));return console.log("Extracted IDs (newClasses):",t),t},n=async(e,s,t,a)=>{console.log("allPlants",e),console.log("removedTitles",s);const n=o(s,e);if(n.length>0){let e="https://saasimplementationserverdev.azurewebsites.net/plantAssignment/declassifyProductToClass",s={id:t,type:a,classes:n};const o=await(0,l.Fd)("POST",e,s);console.log("declassifyResponse:",JSON.stringify(o))}},i=async(e,s,t,a,n,i,c)=>{console.log("Data Received for handleAddData:",e);const r=o(e,s);console.log("newClasses before filtering:",r),console.log("productChilds",i);const d=i.filter((e=>{if("released"===e.state.toLowerCase()){return!n.find((s=>s.identifier===e.id&&"modify"===s.action.toLowerCase()))}return!1}));console.log("NotPropagableChilds ARE:",d);const g=[];r.forEach((e=>{const s=d.filter((s=>!s.classes.includes(e))).map((e=>e.name)).join(", ");""!==s&&"Undefined"!==s&&g.push({ClassID:e,Childs:s})})),console.log("error object savetable",g);let u="";g.forEach((e=>{var t;const a=null===(t=s.find((s=>s.id===e.ClassID)))||void 0===t?void 0:t.title,l="Unable to classify product in ".concat(a," due to unclassified child items: ").concat(e.Childs);u+="".concat(l,"\n")})),console.log("Final Message:\n",u);const p=r.filter((e=>!g.some((s=>s.ClassID===e))));if(console.log("Filtered New Classes (excluding errored ones):",p),p.length>0){const e="https://saasimplementationserverdev.azurewebsites.net/plantAssignment/classifyProductToClass",s={id:t,type:a,classes:p,mode:"classifyParent"};console.log("Classify API Body:",s);try{const t=await(0,l.Fd)("POST",e,s);console.log("Classify Response:",JSON.stringify(t))}catch(h){console.error("Error in Classify API Call:",h)}}if(p.length>0&&i.length>0&&"VPMReference"===a&&c){let e="https://saasimplementationserverdev.azurewebsites.net/plantAssignment/classifyProductToClass",s={id:t,type:a,classes:p,childs:i,mode:"classifychilds"};const o=await(0,l.Fd)("POST",e,s);console.log("child classifyResponse:",JSON.stringify(o))}return{success:!0,message:"Data saved successfully",ErrorObject:g,Finalmessage:u}},c=async(e,s,t,o,n,i,c,r,d,g,u)=>{try{const e="https://oi000186152-us1-space.3dexperience.3ds.com/enovia";console.log("[Save Data] Starting data saving process..."),console.log("Type in Save Table Data:",r),console.log("Final aRRAY IS inside Save:",g),console.log("Proposed Changes in Save",u);const s=await(0,l.fV)(),t=async(e,t,l)=>(console.log("Fetching URL:",e),console.log("Request Body:",JSON.stringify(t,null,2)),new Promise(((n,i)=>{s.authenticatedRequest(e,{method:l,headers:(0,a.A)((0,a.A)({},o),{},{"Content-Type":"application/json"}),data:JSON.stringify(t),type:"json",onComplete:e=>{console.log("Response received:",e),n(e)},onFailure:e=>{console.error("Request failed:",e),i(e)}})})));let i=c.filter((e=>{if(console.log("Processing prodChild:",e),"released"===e.state.toLowerCase()){console.log("Released prodChild:",e);const s=u.find((s=>s.identifier===e.id&&"modify"===s.action.toLowerCase()));return console.log("Matching change for prodChild:",s),!s}return console.log("prodChild state is not 'released':",e.state),!1}));console.log("NotPropagableChilds ARE :",i);let h=[];g.forEach((e=>{if(e.MBOMValue){let s=[];i.forEach((t=>{t.classes.includes(e.id)||s.push({childId:t.id,childName:t.name})})),s.length>0&&h.push({id:e.id,title:e.title,childs:s,type:e.Type})}}));let m="";console.log("ErrorObj IS",h),h.forEach((e=>{let s="";if(Array.isArray(e.childs)&&e.childs.every((e=>e.childName))){const t=e.childs.map((e=>e.childName)).join(", ");console.log("Chilld Titles are",t),s="new"!==e.type.toLowerCase()?"".concat(e.title," MBOM can't be Make due to unclassified child items: ").concat(t):"Unable to classify product ".concat(e.title," due to unclassified child items: ").concat(t),console.log("Message is:",s)}else s="Invalid child data for ".concat(e.title,".");m+="".concat(s,"\n")})),console.log(h),console.log("Concatenated Messages:\n",m);let f=g.filter((e=>"new"===e.Type.toLowerCase()&&!h.some((s=>s.id===e.id)))).map((e=>e.id));console.log("New Classes are:",f);let y={};g.forEach((e=>{!h.some((s=>s.id===e.id))&&("update"===e.Type.toLowerCase()||"new"===e.Type.toLowerCase()&&e.MBOMValue)&&(y[e.MBOMName]=e.MBOMValue)})),console.log("Update body is:",y);let v=g.filter((e=>e.MBOMValue&&!h.some((s=>s.id===e.id)))).map((e=>e.id));if(console.log("Propogateable classes are",v),f.length>0){let e="https://saasimplementationserverdev.azurewebsites.net/plantAssignment/classifyProductToClass",s={id:n,type:r,classes:f,mode:"classifyParent"};const t=await(0,l.Fd)("POST",e,s);console.log("classifyResponse:",JSON.stringify(t))}if(Object.keys(y).length>0){var p;const s="".concat(e,"/resources/v1/modeler/dslib/dslib:ClassifiedItem/").concat(n),a=await t(s,"","GET");console.log("CStamp Response:",a);let o=(null===(p=a.member[0])||void 0===p?void 0:p.cestamp)||"";y.cestamp=o;const i="https://saasimplementationserverdev.azurewebsites.net/plantAssignment/updateClassificationAttribute?id=".concat(n);await(0,l.Fd)("PATCH",i,y),console.log("Updated database successfully.")}if(v.length>0&&c.length>0&&"VPMReference"===r){let e="https://saasimplementationserverdev.azurewebsites.net/plantAssignment/classifyProductToClass",s={id:n,type:r,classes:v,childs:c,mode:"classifychilds"};const t=await(0,l.Fd)("POST",e,s);console.log("child classifyResponse:",JSON.stringify(t))}if(d.length>0){let e="https://saasimplementationserverdev.azurewebsites.net/plantAssignment/declassifyProductToClass",s={id:n,type:r,classes:d};const t=await(0,l.Fd)("POST",e,s);console.log("declassifyResponse:",JSON.stringify(t))}return console.log("All classification API calls completed successfully."),{success:!0,message:"Data saved successfully",ErrorObj:h,Finalmessage:m}}catch(h){return console.error("Error occurred:",h),{success:!1,message:"Failed to save data",error:h}}}}}]);
//# sourceMappingURL=328.90f6b27e.chunk.js.map